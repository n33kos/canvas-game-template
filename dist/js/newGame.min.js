!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("newGame",[],t):"object"==typeof exports?exports.newGame=t():e.newGame=t()}(window,function(){return function(n){var i={};function a(e){if(i[e])return i[e].exports;var t=i[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,a),t.l=!0,t.exports}return a.m=n,a.c=i,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)a.d(n,i,function(e){return t[e]}.bind(null,i));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=1)}([function(e,t,n){"use strict";function i(a,s,o,u){var r,l=0;return"boolean"!=typeof s&&(u=o,o=s,s=void 0),function(){var e=this,t=Number(new Date)-l,n=arguments;function i(){l=Number(new Date),o.apply(e,n)}u&&!r&&i(),r&&clearTimeout(r),void 0===u&&a<t?i():!0!==s&&(r=setTimeout(u?function(){r=void 0}:i,void 0===u?a-t:a))}}Object.defineProperty(t,"__esModule",{value:!0}),t.throttle=i,t.debounce=function(e,t,n){return void 0===n?i(e,t,!1):i(e,n,!1!==t)}},function(e,t,n){"use strict";var i=o(n(2)),a=o(n(4)),s=o(n(5));function o(e){return e&&e.__esModule?e:{default:e}}var u={Game:i.default,GameState:a.default,UI:s.default};document.addEventListener("DOMContentLoaded",function(e){var t=new u.GameState;t.Game=new u.Game(t),t.Game.init(),t.UI=new u.UI(t),t.UI.init()})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),s=n(0),o=n(3),u=(i=o)&&i.__esModule?i:{default:i};var r=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.GameState=e}return a(t,[{key:"init",value:function(){this.setDimensions(),this.initCanvas(),this.initAudio(),this.initControls()}},{key:"setDimensions",value:function(){this.width=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,this.height=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}},{key:"initCanvas",value:function(){var e=this,t=document.querySelector("canvas");t.width=this.width,t.height=this.height,this.cx=this.width/2,this.cy=this.height/2;var n=(this.GameState.canvas=t).getContext("2d");this.GameState.ctx=n,this.resizeCanvas(),window.addEventListener("resize",(0,s.throttle)(200,function(){e.setDimensions(),e.resizeCanvas()}))}},{key:"resizeCanvas",value:function(){this.GameState.canvas.width=this.width,this.GameState.canvas.height=this.height,this.cx=this.width/2,this.cy=this.height/2}},{key:"initAudio",value:function(){var e=new(window.AudioContext||window.webkitAudioContext),t=(this.GameState.audioContext=e).createGain();t.gain.value=.75,t.connect(e.destination),this.masterAudioNode=t}},{key:"initControls",value:function(){this.control=new u.default(this),this.control.init()}},{key:"initRender",value:function(){this.isRunning||(this.isRunning=!0,this.render())}},{key:"play",value:function(){this.loadLevel(),this.initRender(),this.GameState.isPaused&&this.togglePause()}},{key:"restart",value:function(){1==confirm("Are you sure you want to exit the level?")&&(this.endGame(),this.GameState.UI.setScreen("level"))}},{key:"togglePause",value:function(){this.GameState.isPaused=!this.GameState.isPaused,this.GameState.isPaused||(this.GameState.audioContext.resume(),this.section.noteTriggers.forEach(function(e){return e.recalculateEndTime()})),this.GameState.isPaused&&this.GameState.audioContext.suspend()}},{key:"calculateDeltaTime",value:function(){var e=Date.now();this.deltaTime=e-this.lastUpdate,this.lastUpdate=e}},{key:"endGame",value:function(){this.level=null,this.isRunning=!1,this.GameState.isPaused=!0,this.GameState.score=0}},{key:"shouldRenderGameplay",value:function(){return!this.GameState.isPaused}},{key:"render",value:function(){this.isRunning&&window.requestAnimationFrame(this.render.bind(this)),this.shouldRenderGameplay()&&(this.GameState.ctx.clearRect(0,0,this.GameState.canvas.width,this.GameState.canvas.height),this.calculateDeltaTime(),this.control.handlePressedKeys())}}]),t}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),a=n(0);var s=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.Game=e,this.isMouseDown=!1,this.oldPosition=0,this.pressedKeys=[],this.debounceValue=10}return i(t,[{key:"init",value:function(){var t=this;document.addEventListener("mousemove",(0,a.throttle)(this.debounceValue,function(e){return t.handleMouseMove(e)})),document.addEventListener("mousedown",this.handleMouseDown),document.addEventListener("mouseup",function(e){t.isMouseDown=!1}),document.addEventListener("touchmove",(0,a.throttle)(this.debounceValue,function(e){return t.handleTouchMove(e)})),document.addEventListener("touchstart",this.handleTouchStart),document.addEventListener("touchend",function(e){t.isMouseDown=!1}),document.onkeydown=this.handleKeyDown.bind(this),document.onkeyup=this.handleKeyUp.bind(this)}},{key:"handleTouchStart",value:function(e){this.isMouseDown=!0,this.oldPosition=e.targetTouches[0].clientX}},{key:"handleTouchMove",value:function(e){if(e.preventDefault(),this.isMouseDown&&!this.Game.isPaused)for(var t=0;t<e.targetTouches.length;t++)this.oldPosition=e.targetTouches[t].clientX}},{key:"handleMouseDown",value:function(e){this.isMouseDown=!0,this.oldPosition=e.clientX}},{key:"handleMouseMove",value:function(e){this.isMouseDown&&!this.Game.isPaused&&(this.oldPosition=e.clientX)}},{key:"handleKeyDown",value:function(e){this.pressedKeys.includes(e.keyCode)||this.pressedKeys.push(e.keyCode)}},{key:"handleKeyUp",value:function(e){var t=this.pressedKeys.indexOf(e.keyCode);-1<t&&this.pressedKeys.splice(t,1)}},{key:"handlePressedKeys",value:function(){this.pressedKeys.includes(37),this.pressedKeys.includes(39)}}]),t}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.level=0,this.score=0,this.audioContext=null,this.canvas=null,this.ctx=null,this.isPaused=!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();var a=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.GameState=e,this.screens=document.querySelectorAll("[data-screen]"),this.buttons={mute:document.querySelectorAll('[data-nav="mute"]'),quit:document.querySelectorAll('[data-nav="quit"]'),screens:document.querySelectorAll("[data-target-screen]"),play:document.querySelectorAll("[data-gamestate-play]"),pause:document.querySelectorAll("[data-gamestate-pause]"),restart:document.querySelectorAll("[data-gamestate-restart]"),fullscreen:document.querySelectorAll('[data-nav="fullscreen"]'),level:document.querySelectorAll("[data-gamestate-change-level]")},this.isFullscreen=!1}return i(t,[{key:"init",value:function(){this.initListenters(),this.setScreen("mainmenu")}},{key:"initListenters",value:function(){var n=this;Array.from(this.buttons.play).forEach(function(e){e.addEventListener("click",function(){return n.GameState.Game.play()})}),Array.from(this.buttons.pause).forEach(function(e){e.addEventListener("click",function(){return n.GameState.Game.togglePause()})}),Array.from(this.buttons.restart).forEach(function(e){e.addEventListener("click",function(){return n.GameState.Game.restart()})}),Array.from(this.buttons.fullscreen).forEach(function(e){e.addEventListener("click",function(){return n.toggleFullscreen()})}),Array.from(this.buttons.level).forEach(function(e){e.addEventListener("click",function(e){n.GameState.level+=parseInt(e.target.dataset.gamestateChangeLevel,10),n.GameState.level>=n.GameState.Game.levels.length&&(n.GameState.level=0),n.GameState.level<0&&(n.GameState.level=n.GameState.Game.levels.length),n.updateLevel(n.GameState.Game.levels[n.GameState.level])})}),Array.from(this.buttons.quit).forEach(function(e){e.addEventListener("click",function(){return window.close()})}),Array.from(this.buttons.mute).forEach(function(e){e.addEventListener("click",function(e){var t=n.GameState.Game.audioContext;"running"===t.state?t.suspend().then(function(){e.target.innerHTML="Resume"}):"suspended"===t.state&&t.resume().then(function(){e.target.innerHTML="Mute"})})}),Array.from(this.buttons.screens).forEach(function(e){e.addEventListener("click",n.initTransitions.bind(n))})}},{key:"initTransitions",value:function(e){this.setScreen(e.target.dataset.targetScreen)}},{key:"setScreen",value:function(t){Array.from(this.screens).forEach(function(e){e.dataset.screen===t?e.classList.add("active"):e.classList.remove("active")})}},{key:"toggleFullscreen",value:function(){var e=document.documentElement;this.isFullscreen||(e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()),this.isFullscreen&&(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()),this.isFullscreen=!this.isFullscreen}},{key:"updateScore",value:function(t){var e=document.querySelectorAll('[data-ui="score"]');Array.from(e).forEach(function(e){e.innerHTML=t})}},{key:"updateLevel",value:function(t){Array.from(document.querySelectorAll('[data-ui="level"]')).forEach(function(e){e.innerHTML=t.name})}}]),t}();t.default=a}])});