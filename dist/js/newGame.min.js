!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("newGame",[],t):"object"==typeof exports?exports.newGame=t():e.newGame=t()}(window,function(){return function(n){var i={};function r(e){if(i[e])return i[e].exports;var t=i[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}return r.m=n,r.c=i,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t,n){"use strict";function i(r,o,u,a){var s,l=0;return"boolean"!=typeof o&&(a=u,u=o,o=void 0),function(){var e=this,t=Number(new Date)-l,n=arguments;function i(){l=Number(new Date),u.apply(e,n)}a&&!s&&i(),s&&clearTimeout(s),void 0===a&&r<t?i():!0!==o&&(s=setTimeout(a?function(){s=void 0}:i,void 0===a?r-t:r))}}Object.defineProperty(t,"__esModule",{value:!0}),t.throttle=i,t.debounce=function(e,t,n){return void 0===n?i(e,t,!1):i(e,n,!1!==t)}},function(e,t,n){"use strict";var i=c(n(2)),r=c(n(3)),o=c(n(4)),u=c(n(5)),a=c(n(7)),s=c(n(8)),l=c(n(12));function c(e){return e&&e.__esModule?e:{default:e}}var d={Audio:i.default,Canvas:r.default,Controls:o.default,GameState:u.default,Renderer:a.default,Scene:s.default,UI:l.default};document.addEventListener("DOMContentLoaded",function(e){var t=new d.GameState;t.Audio=new d.Audio(t),t.Audio.init(),t.UI=new d.UI(t),t.UI.init(),t.Controls=new d.Controls(t),t.Controls.init(),t.Canvas=new d.Canvas(t),t.Canvas.init(),t.Scene=new d.Scene(t),t.Scene.init(),t.Renderer=new d.Renderer(t),t.Renderer.init()})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();n(0);var r=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.GameState=e,this.audioContext=null,this.masterAudioNode=null}return i(t,[{key:"init",value:function(){var e=new(window.AudioContext||window.webkitAudioContext),t=(this.audioContext=e).createGain();t.gain.value=.75,t.connect(e.destination),this.masterAudioNode=t}}]),t}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),r=n(0);var o=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.GameState=e,this.cx=null,this.cy=null,this.canvas=null,this.ctx=null}return i(t,[{key:"init",value:function(){this.setDimensions(),this.initCanvas()}},{key:"setDimensions",value:function(){this.width=(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)*window.devicePixelRatio,this.height=(window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight)*window.devicePixelRatio}},{key:"initCanvas",value:function(){var e=this,t=document.querySelector("canvas");t.width=this.width,t.height=this.height,this.cx=this.width/2,this.cy=this.height/2;var n=(this.canvas=t).getContext("2d");this.ctx=n,this.resizeCanvas(),window.addEventListener("resize",(0,r.throttle)(1e3,function(){e.setDimensions(),e.resizeCanvas()}))}},{key:"resizeCanvas",value:function(){this.canvas.width=this.width,this.canvas.height=this.height,this.cx=this.width/2,this.cy=this.height/2}},{key:"clear",value:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}}]),t}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),r=n(0);var o=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.GameState=e,this.isMouseDown=!1,this.oldPosition=0,this.pressedKeys=[],this.debounceValue=10}return i(t,[{key:"init",value:function(){var t=this;document.addEventListener("mousemove",(0,r.throttle)(this.debounceValue,function(e){return t.handleMouseMove(e)})),document.addEventListener("mousedown",this.handleMouseDown),document.addEventListener("mouseup",function(e){t.isMouseDown=!1}),document.addEventListener("touchmove",(0,r.throttle)(this.debounceValue,function(e){return t.handleTouchMove(e)})),document.addEventListener("touchstart",this.handleTouchStart),document.addEventListener("touchend",function(e){t.isMouseDown=!1}),document.onkeydown=this.handleKeyDown.bind(this),document.onkeyup=this.handleKeyUp.bind(this)}},{key:"handleTouchStart",value:function(e){this.isMouseDown=!0,this.oldPosition=e.targetTouches[0].clientX}},{key:"handleTouchMove",value:function(e){if(e.preventDefault(),this.isMouseDown&&!this.GameState.isPaused)for(var t=0;t<e.targetTouches.length;t++)this.oldPosition=e.targetTouches[t].clientX}},{key:"handleMouseDown",value:function(e){this.isMouseDown=!0,this.oldPosition=e.clientX}},{key:"handleMouseMove",value:function(e){this.isMouseDown&&!this.GameState.isPaused&&(this.oldPosition=e.clientX)}},{key:"handleKeyDown",value:function(e){this.pressedKeys.includes(e.keyCode)||this.pressedKeys.push(e.keyCode)}},{key:"handleKeyUp",value:function(e){var t=this.pressedKeys.indexOf(e.keyCode);-1<t&&this.pressedKeys.splice(t,1)}},{key:"handlePressedKeys",value:function(){this.pressedKeys.includes(37),this.pressedKeys.includes(39)}}]),t}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),r=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(n(6));var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.audioContext=null,this.canvas=null,this.ctx=null,this.deltaTime=1,this.isPaused=!1,this.level=null,this.levels=[],this.score=0,this.playerName=r.playerName}return i(e,[{key:"play",value:function(){this.loadLevel(),this.isPaused&&this.togglePause()}},{key:"restart",value:function(){1==confirm("Are you sure you want to exit the level?")&&(this.endGame(),this.UI.setScreen("level"))}},{key:"togglePause",value:function(){this.isPaused=!this.isPaused,this.isPaused&&this.Audio.audioContext.resume(),this.isPaused&&this.Audio.audioContext.suspend()}},{key:"endGame",value:function(){this.level=null,this.isRunning=!1,this.isPaused=!0,this.score=0}},{key:"loadLevel",value:function(){}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={playerName:"Player 1"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();var r=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.GameState=e,this.isRunning=!1,this.lastUpdate=Date.now()}return i(t,[{key:"init",value:function(){this.isRunning||(this.isRunning=!0,this.render())}},{key:"calculateDeltaTime",value:function(){var e=Date.now();this.GameState.deltaTime=e-this.lastUpdate,this.lastUpdate=e}},{key:"shouldRender",value:function(){return!this.GameState.isPaused}},{key:"render",value:function(){var t=this;this.isRunning&&window.requestAnimationFrame(this.render.bind(this)),this.shouldRender()&&(this.GameState.Canvas.clear(),this.calculateDeltaTime(),this.GameState.Controls.handlePressedKeys(),this.GameState.Scene.entities.forEach(function(e){e.draw(t.GameState.Canvas.ctx)}))}}]),t}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();var r=n(9),o=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.GameState=e,this.entities=[]}return i(t,[{key:"init",value:function(){}},{key:"add",value:function(e){e.uuid=r(),this.entities.push(e)}},{key:"remove",value:function(t){this.entities=this.entities.filter(function(e){return e.uuid!==t})}},{key:"clearScene",value:function(){this.entities=[]}}]),t}();t.default=o},function(e,t,n){"use strict";var u=n(10),a=n(11);e.exports=function(e,t,n){var i=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var r=(e=e||{}).random||(e.rng||u)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t)for(var o=0;o<16;++o)t[i+o]=r[o];return t||a(r)}},function(e,t,n){"use strict";var i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(i){var r=new Uint8Array(16);e.exports=function(){return i(r),r}}else{var o=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},function(e,t,n){"use strict";for(var r=[],i=0;i<256;++i)r[i]=(i+256).toString(16).substr(1);e.exports=function(e,t){var n=t||0,i=r;return[i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]]].join("")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();var r=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.GameState=e,this.screens=document.querySelectorAll("[data-screen]"),this.buttons={mute:document.querySelectorAll('[data-nav="mute"]'),quit:document.querySelectorAll('[data-nav="quit"]'),screens:document.querySelectorAll("[data-target-screen]"),play:document.querySelectorAll("[data-gamestate-play]"),pause:document.querySelectorAll("[data-gamestate-pause]"),restart:document.querySelectorAll("[data-gamestate-restart]"),fullscreen:document.querySelectorAll('[data-nav="fullscreen"]'),level:document.querySelectorAll("[data-gamestate-change-level]")},this.isFullscreen=!1}return i(t,[{key:"init",value:function(){this.initListenters(),this.setScreen("mainmenu")}},{key:"initListenters",value:function(){var n=this;Array.from(this.buttons.play).forEach(function(e){e.addEventListener("click",function(){return n.GameState.play()})}),Array.from(this.buttons.pause).forEach(function(e){e.addEventListener("click",function(){return n.GameState.togglePause()})}),Array.from(this.buttons.restart).forEach(function(e){e.addEventListener("click",function(){return n.GameState.restart()})}),Array.from(this.buttons.fullscreen).forEach(function(e){e.addEventListener("click",function(){return n.toggleFullscreen()})}),Array.from(this.buttons.level).forEach(function(e){e.addEventListener("click",function(e){n.GameState.level+=parseInt(e.target.dataset.gamestateChangeLevel,10),n.GameState.level>=n.GameState.levels.length&&(n.GameState.level=0),n.GameState.level<0&&(n.GameState.level=n.GameState.levels.length),n.updateLevel(n.GameState.levels[n.GameState.level])})}),Array.from(this.buttons.quit).forEach(function(e){e.addEventListener("click",function(){return window.close()})}),Array.from(this.buttons.mute).forEach(function(e){e.addEventListener("click",function(e){var t=n.GameState.Audio.audioContext;"running"===t.state?t.suspend().then(function(){e.target.innerHTML="Resume"}):"suspended"===t.state&&t.resume().then(function(){e.target.innerHTML="Mute"})})}),Array.from(this.buttons.screens).forEach(function(e){e.addEventListener("click",n.initTransitions.bind(n))})}},{key:"initTransitions",value:function(e){this.setScreen(e.target.dataset.targetScreen)}},{key:"setScreen",value:function(t){Array.from(this.screens).forEach(function(e){e.dataset.screen===t?e.classList.add("active"):e.classList.remove("active")})}},{key:"toggleFullscreen",value:function(){var e=document.documentElement;this.isFullscreen||(e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()),this.isFullscreen&&(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()),this.isFullscreen=!this.isFullscreen}},{key:"updateScore",value:function(t){var e=document.querySelectorAll('[data-ui="score"]');Array.from(e).forEach(function(e){e.innerHTML=t})}},{key:"updateLevel",value:function(t){t&&Array.from(document.querySelectorAll('[data-ui="level"]')).forEach(function(e){e.innerHTML=t.name})}}]),t}();t.default=r}])});